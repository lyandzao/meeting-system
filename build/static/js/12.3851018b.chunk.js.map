{"version":3,"sources":["components/commons/Button/Button.tsx","components/commons/Button/index.ts","components/commons/Button/Button.module.scss","services/apis/item.ts","assets/images/item-default@2x.png","utils/itemDataTransfer.ts","components/commons/ProjectItem/ProjectItem.module.scss","components/commons/ProjectItem/ProjectItem.tsx","components/commons/ProjectItem/index.ts","components/bars/SelectBar/SelectBar.module.scss","pages/Home/Home.module.scss","components/bars/SelectBar/SelectBar.tsx","pages/Home/index.tsx"],"names":["MyButton","type","value","className","color","fontSize","onClick","loading","disabled","size","htmlType","style","btn","module","exports","publishItem","meetingJson","taskJson","guestJson","post","config","data","encodeURIComponent","JSON","stringify","msg","getHomeItemList","offset","limit","get","params","getItemTypes","getItemCount","getHomeItemListByCondition","getItemInfo","meetingId","applyItem","favoriteItem","quitItem","quitFavorite","getUserRelatedItem","transformItemList","map","item","id","meetingid","src","title","mName","time","getTime","startTime","closeTime","favorite","transformAwesomeItemList","isMy","isMyItem","Item","BtnColor","jumpTo","btnShow","ifShowBtn","useBoolean","useImmer","already","BtnStatus","history","useHistory","container","push","img","itemDefaultSrc","alt","titleBar","StarOutlined","timeBar","ClockCircleOutlined","font","state","Button","SelectBar","name","typeList","typeTarget","onChange","typeName","Number","typeid","active","key","Home","useState","setType","page","setPage","meetingNum","setMeetingNum","meetingList","setMeetingList","setTypeList","meetingNumR","useRequest","cacheKey","onSuccess","result","count","onError","console","log","meetingListR","meetings","error","typeListR","types","unshift","typeMeetingListR","manual","handlePagination","a","run","handleTypeChange","e","target","useUnmount","cancel","spinning","bar","itemList","list","pagination","pageSize","current","total","hideOnSinglePage"],"mappings":"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","file":"static/js/12.3851018b.chunk.js","sourcesContent":["/**\r\n * @ Author: zao\r\n * @ Create Time: 2020-03-20\r\n * @ Modified by: zao\r\n * @ Description: 全局button组件\r\n */\r\n\r\nimport React, { ReactElement } from 'react';\r\nimport {Button} from 'antd'\r\n\r\nimport style from './Button.module.scss';\r\n\r\ninterface Props {\r\n  type?: 'button' | 'reset' | 'submit';\r\n  value: string;\r\n  className?: string;\r\n  onClick?: any;\r\n  color?: string;\r\n  fontSize?: number;\r\n  loading?: boolean;\r\n  disabled?: boolean;\r\n  size?:'large'|'middle'|'small';\r\n}\r\n\r\nfunction MyButton({ type = 'button', value, className, color, fontSize, onClick,loading=false,disabled,size }: Props): ReactElement {\r\n  return (\r\n    // <button type={type} className={`${style.btn} ${className}`} style={{ 'backgroundColor': color, 'fontSize': `${fontSize}px` }} onClick={onClick}>{value}</button>\r\n    <Button type='primary' size={size} htmlType={type} loading={loading} className={`${style.btn} ${className}`} style={{ 'backgroundColor': color, 'fontSize': `${fontSize}px` }} onClick={onClick} disabled={disabled}>{value}</Button>\r\n  )\r\n}\r\n\r\nexport default MyButton\r\n","export {default} from './Button'","// extracted by mini-css-extract-plugin\nmodule.exports = {\"btn\":\"Button_btn__2fuTG\"};","import * as config from './config'\r\nimport { get, post } from '../axios'\r\n\r\nexport interface Iitem {\r\n  meetingid?: number;\r\n  mName?: string;\r\n  location?: string;\r\n  startTime?: string;\r\n  closeTime?: string;\r\n  introduction?: string;\r\n  schedule?: string;\r\n  needvolunteer?: string;\r\n  typeid?: number;\r\n  organizer?: string;\r\n  hostedby?: string;\r\n  communicate?: string;\r\n}\r\n\r\nexport interface Itask{\r\n  taskinfo?: string;\r\n  workingtime?: string;\r\n  numbers?: string;\r\n}\r\n\r\nexport interface Iguest{\r\n  introduction?: string;\r\n  name?: string;\r\n  ico?: any;\r\n}\r\n\r\n\r\n\r\n/**\r\n * 发布会议\r\n * @param meeting 会议json\r\n * @param volunt 志愿者json\r\n * @param guests 嘉宾json\r\n */\r\nexport const publishItem = (meetingJson: Iitem, taskJson: Itask[] = [], guestJson:Iguest= {}) => post(config.ADD_MEETING_INFO,\r\n  {\r\n    data: {\r\n      meetingJson: encodeURIComponent(JSON.stringify(meetingJson)),\r\n      taskJson: encodeURIComponent(JSON.stringify(taskJson)),\r\n      guestJson: encodeURIComponent(JSON.stringify(guestJson))\r\n    }, msg: '发布成功'\r\n  })\r\n\r\nexport const addGuest = (meetingId: string, introduction: string, name: string, ico: any) => post(config.ADD_GUEST, {\r\n  data: {\r\n    meetingId,\r\n    introduction,\r\n    name,\r\n    ico\r\n    }\r\n  })\r\n\r\n/**\r\n * 获取主页会议列表\r\n * @param offset 起始位置\r\n * @param limit 条数\r\n * @returns \r\n */\r\nexport const getHomeItemList = (offset: number, limit: number) => {\r\n  return get(\r\n    config._GET_MEETING_HOME_PAGE_DATA,\r\n    { params: { offset, limit } })\r\n}\r\n\r\n/**\r\n * 获取会议主题图\r\n * @param meetingId 会议id\r\n */\r\nexport const getItemIcon = (meetingId: number) => {\r\n  return get(config._GET_MEETING_ICON + meetingId)\r\n}\r\n\r\n/**\r\n * \r\n * @param meetingId 会议id\r\n * @param icon file文件\r\n */\r\nexport const uploadItemIcon = (meetingId: number, icon: any) => {\r\n  return post(config.UPLOAD_MEETING_ICON + meetingId,\r\n    { data: icon }, true)\r\n}\r\n\r\n/**\r\n * 获取会议类型\r\n */\r\nexport const getItemTypes = () => get(config._GET_MEETING_TYPE)\r\n\r\n/**\r\n * 获取会议总数\r\n */\r\nexport const getItemCount=()=>post(config.MEETING_COUNT)\r\n\r\n/**\r\n * 根据会议类型获得列表\r\n * @param type 会议类型\r\n */\r\nexport const getHomeItemListByCondition = (type?: number) => get(config._SEARCH_MEETING_CONDITION, { params: { type } })\r\n\r\n/**\r\n * 获得会议详情\r\n * @param meetingId 会议id\r\n */\r\nexport const getItemInfo = (meetingId: number) => get(config._GET_MEETING_INFO + meetingId)\r\n\r\n/**\r\n * 获取与自己相关的会议信息\r\n * @param type 路径变量中类型：（1为创建 2为参加 3为收藏）\r\n */\r\nexport const getMyItem = (type: number) => get(config.FAVORITE_MEETING)\r\n\r\n/**\r\n * 参加会议\r\n * @param meetingId 会议id\r\n */\r\nexport const applyItem = (meetingId: number) => post(config.ATTEND_MEETING, { data: { meetingId }, msg: '报名成功' })\r\n\r\n/**\r\n * 收藏会议\r\n * @param meetingId 会议id\r\n */\r\nexport const favoriteItem = (meetingId: number) => post(config.FAVORITE_MEETING, { data: { meetingId }, msg: '收藏成功' })\r\n\r\n/**\r\n * 退出会议\r\n * @param meetingId \r\n */\r\nexport const quitItem = (meetingId: number) => post(config.QUIT_MEETING +2+'/'+ meetingId,{ msg: '取消成功' })\r\n\r\n/**\r\n * 取消收藏会议\r\n * @param meetingId\r\n */\r\nexport const quitFavorite = (meetingId: number) => post(config.QUIT_MEETING +3+'/'+meetingId, {  msg: '取消成功' })\r\n\r\n/**\r\n * 获取与自己相关的会议\r\n * @param type 1为创建,2为参加,3为收藏，5志愿者\r\n */\r\nexport const getUserRelatedItem = (type: number) => get(config._GET_USER_RELATED_MEET + type)\r\n\r\n/**\r\n * 获取会议被参加、收藏的次数\r\n * @param meetingId\r\n * @param （2为参加 3为收藏）\r\n */\r\nexport const getRelatedCount = (meetingId: number, type: number) => get(config._GET_MEETING_STATUS_COUNT + type, { params: { meetingId } })\r\n\r\n/**\r\n * 获取自己会议 被参加、收藏、申请志愿者的详细信息\r\n * @param meetingId \r\n * @param type （2为参加 3为收藏）\r\n */\r\nexport const getRelatedInfo = (meetingId: number, type: number) => get(config._GET_USER_CREATED_MEET_INFO + type, { params: { meetingId } })","module.exports = __webpack_public_path__ + \"static/media/item-default@2x.39206224.png\";","import { getTime } from './index'\r\n\r\nexport interface Iitem {\r\n  meetingid: number;\r\n  mName: string | null;\r\n  location: string;\r\n  startTime: string;\r\n  closeTime: string;\r\n  introduction: string;\r\n  schedule: string;\r\n  needvolunteer: number;\r\n  typeid: number;\r\n  organizer: string;\r\n  hostedby: string;\r\n  communicate: string;\r\n}\r\n\r\nexport const transformItemList = (data: Iitem[]) => {\r\n  return data.map(item => {\r\n    return {\r\n      id: item.meetingid,\r\n      src: '',\r\n      title: item.mName,\r\n      time: getTime(item.startTime, item.closeTime,true),\r\n      favorite: false,\r\n    }\r\n  })\r\n}\r\n\r\nexport const transformAwesomeItemList = (data: Iitem[], isMy: boolean) => {\r\n  return data.map(item => {\r\n    return {\r\n      id: item.meetingid,\r\n      src: '',\r\n      title: item.mName,\r\n      time: getTime(item.startTime, item.closeTime,false),\r\n      favorite: false,\r\n      isMyItem:isMy,\r\n    }\r\n  })\r\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"ProjectItem_container__2mSZ0\",\"img\":\"ProjectItem_img__L7Yug\",\"titleBar\":\"ProjectItem_titleBar__IxoZA\",\"timeBar\":\"ProjectItem_timeBar__2Jpkn\",\"title\":\"ProjectItem_title__2x5pZ\",\"time\":\"ProjectItem_time__3f7LI\",\"font\":\"ProjectItem_font__3GXdW\",\"btn\":\"ProjectItem_btn__1dN5y\"};","/**\r\n * @ Author: zao\r\n * @ Create Time: 2020-03-20\r\n * @ Modified by: zao\r\n * @ Description: 全局各个单项比赛，发布的消息item\r\n */\r\n\r\nimport React, {\r\n  ReactElement,\r\n  useState,\r\n} from 'react';\r\n\r\nimport { useImmer } from 'use-immer';\r\n\r\nimport { useHistory } from 'react-router-dom'\r\n\r\nimport Button from '@/components/commons/Button';\r\nimport {useBoolean} from '@umijs/hooks'\r\nimport {\r\n  ClockCircleOutlined,\r\n  StarOutlined,\r\n} from '@ant-design/icons';\r\n\r\nimport { Iitem } from './';\r\nimport style from './ProjectItem.module.scss';\r\nimport itemDefaultSrc from '@/assets/images/item-default@2x.png'\r\n\r\ninterface Props {\r\n  item: Iitem;\r\n  jumpTo: string;\r\n  btnShow?: boolean;\r\n}\r\n\r\nfunction Item({ item,jumpTo,btnShow }: Props): ReactElement {\r\n  enum BtnColor { already = 'rgba(250,167,48,1)', lapse = 'rgba(159,158,157,1)' }\r\n  const ifShowBtn=useBoolean(btnShow)\r\n  const [BtnStatus, setBtnStatus] = useImmer({\r\n    color: BtnColor.already,\r\n    value: '有效'\r\n  })\r\n  const history = useHistory()\r\n\r\n  const handleClick = () => {\r\n    history.push(`/${jumpTo}/${item.id}`)\r\n  }\r\n\r\n  return (\r\n    <div className={style.container} onClick={handleClick}>\r\n      <img className={style.img} src={item.src || itemDefaultSrc} alt=\"\" />\r\n      <div className={style.titleBar}>\r\n        <div className={style.title}>{item.title}</div>\r\n        <StarOutlined />\r\n      </div>\r\n      <div className={style.timeBar}>\r\n        <div className={style.time}>\r\n          <ClockCircleOutlined />\r\n          <div className={style.font}>{item.time}</div>\r\n        </div>\r\n        {ifShowBtn.state ? <Button {...BtnStatus} fontSize={8} className={style.btn} /> : null}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Item\r\n","export { default } from './ProjectItem'\r\n\r\nexport interface Iitem {\r\n  id: string;\r\n  src: string;\r\n  title: string;\r\n  favorite: boolean;\r\n  time: string;\r\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"SelectBar_container__QRBK3\",\"typeName\":\"SelectBar_typeName__UMiNN\",\"typeList\":\"SelectBar_typeList__3GAhH\",\"item\":\"SelectBar_item__2sQUW\",\"active\":\"SelectBar_active__OQNq4\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Home_container__38x0k\",\"bar\":\"Home_bar__I3bPV\",\"itemList\":\"Home_itemList__1aDJi\",\"list\":\"Home_list__1B0mo\",\"pagination\":\"Home_pagination__NtAP-\"};","/**\r\n * @ Author: zao\r\n * @ Create Time: 2020-03-22\r\n * @ Modified by: zao\r\n * @ Description: 主页类别选择组件\r\n * TODO: remember to bind event\r\n */\r\n\r\nimport React, {\r\n  ReactElement,\r\n  useState,\r\n} from 'react';\r\n\r\nimport style from './SelectBar.module.scss';\r\n\r\ninterface Props {\r\n  name: string;\r\n  typeList?: { typeid: number; type: string }[];\r\n  bind?: any;\r\n  className?: string;\r\n  onChange: (...arg: any) => any;\r\n  typeTarget: string;\r\n}\r\n\r\n\r\nfunction SelectBar({ name, typeList, typeTarget, className, onChange }: Props): ReactElement {\r\n  return (\r\n    <div className={`${className} ${style.container}`}>\r\n      <div className={style.typeName}>{name}</div>\r\n      <div className={style.typeList} onChange={onChange}>\r\n        {typeList?.map((item) => (\r\n          <label className={Number(typeTarget) === item.typeid ? style.active : style.item} key={item.typeid}>\r\n            {item.type}\r\n            <input type=\"radio\" name={name} value={item.typeid} />\r\n          </label>\r\n        ))}\r\n      </div>\r\n\r\n    </div >\r\n  )\r\n}\r\n\r\nexport default SelectBar\r\n","// TODO: remember to set item total number\r\n\r\nimport React, {\r\n  ReactElement,\r\n  useState,\r\n  useEffect\r\n} from 'react';\r\n\r\nimport {\r\n  Pagination,\r\n  Spin,\r\n} from 'antd';\r\n\r\nimport SelectBar from '@/components/bars/SelectBar';\r\nimport Item, { Iitem } from '@/components/commons/ProjectItem';\r\nimport { transformItemList } from '@/utils/itemDataTransfer';\r\nimport { useRequest, useUnmount } from '@umijs/hooks';\r\nimport {\r\n  getHomeItemList,\r\n  getItemTypes,\r\n  getHomeItemListByCondition,\r\n  getItemCount\r\n} from '@/services/apis/item';\r\n\r\n\r\nimport style from './Home.module.scss';\r\nimport { useOnMount } from '@/hooks';\r\n\r\ninterface Props {\r\n\r\n}\r\n\r\nfunction Home({ }: Props): ReactElement {\r\n  const PER_PAGE = 9 // 每页的最多item数量\r\n  const [type, setType] = useState('-1') // -1代表首页\r\n  const [page, setPage] = useState(1) // 分页page偏移量\r\n  const [meetingNum, setMeetingNum] = useState(0) // item的总数\r\n  const [meetingList, setMeetingList] = useState<any[]>() // item的数据\r\n  const [typeList, setTypeList] = useState<any[]>() // 类别\r\n\r\n  const meetingNumR = useRequest(getItemCount, {\r\n    cacheKey: 'meetingNum',\r\n    onSuccess: (result, params) => {\r\n      if (result.data) {\r\n        setMeetingNum(result.data.count)\r\n      }\r\n    },\r\n    onError: (result, params) => {\r\n      console.log(result)\r\n      \r\n    }\r\n  })\r\n  const meetingListR = useRequest((page = 0) => getHomeItemList(page, PER_PAGE), {\r\n    cacheKey:'homeList',\r\n    onSuccess: (result, params) => {\r\n      if (result.data) {\r\n        setMeetingList(transformItemList(result.data.meetings))\r\n      }\r\n    },\r\n    onError: (error) => {\r\n      console.log('错误')\r\n      \r\n      console.log(error)\r\n      \r\n    }\r\n  })\r\n  const typeListR = useRequest(getItemTypes, {\r\n    cacheKey: 'meetingType',\r\n    onSuccess: (result, params) => {\r\n      if (result.data) {\r\n        let types: any[] = result.data.types.map((item: any) => item)\r\n        types.unshift({ typeid: -1, type: '全部' })\r\n        setTypeList(types)\r\n      }\r\n    }\r\n  })\r\n  const typeMeetingListR = useRequest((type: number) => getHomeItemListByCondition(type), {\r\n    manual: true,\r\n    onSuccess: (result, params) => {\r\n      if (result.data) {\r\n        setMeetingList(transformItemList(result.data.meetings))\r\n      }\r\n    }\r\n  })\r\n  // 处理分页\r\n  const handlePagination = async (page: number) => {\r\n    setPage(page)\r\n    meetingListR.run((page - 1) * 9)\r\n  }\r\n  // 处理条件搜索\r\n  const handleTypeChange = async (e: any) => {\r\n    setType(e.target.value)\r\n    if (e.target.value === '-1') {\r\n      setPage(1)\r\n      meetingListR.run(0)\r\n      meetingNumR.run()\r\n    } else {\r\n      typeMeetingListR.run(e.target.value)\r\n    }\r\n  }\r\n\r\n  useUnmount(() => {\r\n    meetingNumR.cancel('cancel meetingNumR')\r\n    meetingListR.cancel('cancel meetingListR')\r\n    typeListR.cancel('cancel typeListR')\r\n    \r\n  })\r\n\r\n  return (\r\n    <div className={style.container}>\r\n      <Spin spinning={typeListR.loading}>\r\n        <SelectBar className={style.bar} name='类别' typeTarget={type} typeList={typeList} onChange={(e: any) => handleTypeChange(e)} />\r\n      </Spin>\r\n\r\n\r\n      <div className={style.itemList}>\r\n        <Spin spinning={type === '-1' ? meetingListR.loading : typeMeetingListR.loading}>\r\n          <div className={style.list}>\r\n            {meetingList?.map((item: any) => {\r\n              return <Item jumpTo={'info'} key={item.id} item={item} />\r\n            })}\r\n          </div>\r\n        </Spin>\r\n\r\n        {\r\n          type === '-1' ?\r\n            <Spin spinning={meetingNumR.loading}>\r\n              <Pagination className={style.pagination} pageSize={PER_PAGE} current={page} total={meetingNum} onChange={handlePagination} hideOnSinglePage={true} />\r\n            </Spin> : null\r\n        }\r\n      </div>\r\n\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Home\r\n"],"sourceRoot":""}